---
import Layout from '../../layouts/Layout.astro'
import { getCollection } from 'astro:content'
import type { GetStaticPaths } from 'astro'

export const getStaticPaths = (async () => {
	const posts = await getCollection('posts')
	return posts.map(post => ({
		params: { slug: post.slug },
		props: { post }
	}))
}) satisfies GetStaticPaths

interface Props {
	post: any
}

const { post } = Astro.props
const { Content } = await post.render()
---

<Layout title={post.data.title}>
	<article class="mx-auto max-w-3xl py-12 px-4">
		<header class="mb-8">
			<h1 class="text-4xl md:text-5xl font-bold mb-2 text-gray-900">{post.data.title}</h1>
			<div class="flex items-center gap-4 text-sm text-gray-600 border-b border-gray-200 pb-4">
				<span>{post.data.author}</span>
				<time datetime={post.data.pubDate.toISOString()}>
					{post.data.pubDate.toLocaleDateString('es-MX', { 
						year: 'numeric', 
						month: 'long', 
						day: 'numeric' 
					})}
				</time>
			</div>
		</header>

		{post.data.tags && post.data.tags.length > 0 && (
			<div class="flex flex-wrap gap-2 mb-8">
				{post.data.tags.map((tag: string) => (
					<a href={`/tags/${tag}`} class="text-xs bg-blue-50 text-blue-700 px-2.5 py-1 rounded-full font-medium hover:bg-blue-100 transition-colors">
						#{tag}
					</a>
				))}
			</div>
		)}

		{post.data.image?.url && (
			<div class="aspect-video overflow-hidden rounded-xl mb-8 bg-gray-100">
				<img 
					src={post.data.image.url} 
					alt={post.data.image.alt || post.data.title}
					class="w-full h-full object-cover"
				/>
			</div>
		)}

		<section class="prose prose-lg max-w-none mb-8">
			<Content />
		</section>

		<footer class="mt-12 pt-8 border-t border-gray-200">
			<a 
				href="/posts" 
				class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium"
			>
				‚Üê Volver al blog
			</a>
		</footer>
	</article>
</Layout>
